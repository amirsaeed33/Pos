<div class="card">
    <span class="text-900 text-xl font-bold mb-4 block">Create User</span>
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        <div class="grid formgrid p-fluid">
            <div class="field mb-4 col-12 md:col-6">
                <label for="userName" class="font-medium text-900">Username <span class="text-red-500">*</span></label>
                <input id="userName" type="text" pInputText formControlName="userName" 
                    [class.ng-invalid]="userForm.get('userName')?.invalid && userForm.get('userName')?.touched">
                <small class="p-error" *ngIf="userForm.get('userName')?.invalid && userForm.get('userName')?.touched">
                    Username is required
                </small>
            </div>

            <div class="field mb-4 col-12 md:col-6">
                <label for="emailAddress" class="font-medium text-900">Email <span class="text-red-500">*</span></label>
                <input id="emailAddress" type="email" pInputText formControlName="emailAddress"
                    [class.ng-invalid]="userForm.get('emailAddress')?.invalid && userForm.get('emailAddress')?.touched">
                <small class="p-error" *ngIf="userForm.get('emailAddress')?.invalid && userForm.get('emailAddress')?.touched">
                    <span *ngIf="userForm.get('emailAddress')?.errors?.['required']">Email is required</span>
                    <span *ngIf="userForm.get('emailAddress')?.errors?.['email']">Invalid email format</span>
                </small>
            </div>

            <div class="field mb-4 col-12 md:col-6">
                <label for="name" class="font-medium text-900">First Name <span class="text-red-500">*</span></label>
                <input id="name" type="text" pInputText formControlName="name"
                    [class.ng-invalid]="userForm.get('name')?.invalid && userForm.get('name')?.touched">
                <small class="p-error" *ngIf="userForm.get('name')?.invalid && userForm.get('name')?.touched">
                    First name is required
                </small>
            </div>

            <div class="field mb-4 col-12 md:col-6">
                <label for="surname" class="font-medium text-900">Last Name <span class="text-red-500">*</span></label>
                <input id="surname" type="text" pInputText formControlName="surname"
                    [class.ng-invalid]="userForm.get('surname')?.invalid && userForm.get('surname')?.touched">
                <small class="p-error" *ngIf="userForm.get('surname')?.invalid && userForm.get('surname')?.touched">
                    Last name is required
                </small>
            </div>

            <div class="field mb-4 col-12 md:col-6">
                <label for="password" class="font-medium text-900">Password <span class="text-red-500">*</span></label>
                <input id="password" type="password" pInputText formControlName="password"
                    [class.ng-invalid]="userForm.get('password')?.invalid && userForm.get('password')?.touched">
                <small class="p-error" *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched">
                    <span *ngIf="userForm.get('password')?.errors?.['required']">Password is required</span>
                    <span *ngIf="userForm.get('password')?.errors?.['minlength']">Password must be at least 6 characters</span>
                </small>
            </div>

            <div class="field mb-4 col-12 md:col-6">
                <label for="roles" class="font-medium text-900">Roles</label>
                <p-multiSelect inputId="roles" [options]="roles" optionLabel="displayName" optionValue="name" 
                    [(ngModel)]="selectedRoles" [ngModelOptions]="{standalone: true}"
                    placeholder="Select Roles" [filter]="true" [showClear]="true">
                </p-multiSelect>
            </div>

            <div class="field mb-4 col-12">
                <p-checkbox formControlName="isActive" inputId="isActive" [binary]="true"></p-checkbox>
                <label for="isActive" class="ml-2">Active</label>
            </div>

            <div class="col-12 flex gap-2">
                <button type="submit" pButton pRipple label="Create User" class="w-auto" 
                    [disabled]="loading || userForm.invalid">
                    <i *ngIf="loading" class="pi pi-spin pi-spinner mr-2"></i>
                    <span *ngIf="!loading">Create User</span>
                    <span *ngIf="loading">Creating...</span>
                </button>
                <button type="button" pButton pRipple label="Cancel" class="p-button-outlined w-auto" 
                    (click)="onCancel()" [disabled]="loading">
                </button>
            </div>
        </div>
    </form>
    <p-toast></p-toast>
</div>
